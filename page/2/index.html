<!DOCTYPE html><html lang="zh-CN" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Grapymage的个人博客</title><meta name="author" content="Grapymage"><meta name="copyright" content="Grapymage"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#0d0d0d"><meta property="og:type" content="website">
<meta property="og:title" content="Grapymage的个人博客">
<meta property="og:url" content="https://zhangtingyu11.github.io/page/2/index.html">
<meta property="og:site_name" content="Grapymage的个人博客">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://zhangtingyu11.github.io/img/avatar.jpeg">
<meta property="article:author" content="Grapymage">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://zhangtingyu11.github.io/img/avatar.jpeg"><link rel="shortcut icon" href="/img/avatar.jpeg"><link rel="canonical" href="https://zhangtingyu11.github.io/page/2/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Grapymage的个人博客',
  isPost: false,
  isHome: true,
  isHighlightShrink: false,
  isToc: false,
  postUpdate: '2024-06-26 15:06:09'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.0.0"><link href="https://cdn.bootcss.com/KaTeX/0.11.1/katex.min.css" rel="stylesheet" /></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/avatar.jpeg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">119</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">66</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">56</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-book"></i><span> 文章</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-file-archive"></i><span> 归档</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="page" id="body-wrap"><header class="full_page" id="page-header" style="background-image: url('/img/index.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title="Grapymage的个人博客"><span class="site-name">Grapymage的个人博客</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-book"></i><span> 文章</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-file-archive"></i><span> 归档</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="site-info"><h1 id="site-title">Grapymage的个人博客</h1><div id="site-subtitle"><span id="subtitle"></span></div></div><div id="scroll-down"><i class="fas fa-angle-down scroll-down-effects"></i></div></header><main class="layout" id="content-inner"><div class="recent-posts" id="recent-posts"><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2024/06/06/deep_learning/interview/evaluation_metrics/kitti_3d_metrics/" title="KITTI 3D数据集评价指标">KITTI 3D数据集评价指标</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2024-06-06T13:46:37.000Z" title="发表于 2024-06-06 21:46:37">2024-06-06</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/">深度学习</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/%E8%AF%84%E4%BB%B7%E6%8C%87%E6%A0%87/">评价指标</a></span></div><div class="content">AP11
主要分三类, Easy, Moderate, Hard
针对每一类会过滤GT框, 只留下这个难度类别的包围框
然后根据PR曲线, 计算Recall为0, 0.1, 0.2, 0.3, …, 1.0的情况下的Precision, 然后对这11个Precision求平均
AP40
主要分三类, Easy, Moderate, Hard
针对每一类会过滤GT框, 只留下这个难度类别的包围框
然后根据PR曲线, 计算Recall为0.025, 0.050, 0.075, …, 1.0的情况下的Precision, 然后对这40个Precision求平均
AOS
AOS=111∑r∈{0,0.1,..,1}max⁡r~:r~≥rs(r~)AOS=\frac1{11}\sum_{r\in\{0,0.1,..,1\}}\max_{\tilde{r}:\tilde{r}\geq r}s(\tilde{r})
AOS=111​r∈{0,0.1,..,1}∑​r~:r~≥rmax​s(r~)
s(r)=1∣D(r)∣∑i∈D(r)1+cos⁡Δθ(i)2δis(r)=\frac1{|\mathc ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2024/06/06/deep_learning/interview/evaluation_metrics/coco_metrix/" title="COCO数据集评价指标">COCO数据集评价指标</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2024-06-06T13:29:33.000Z" title="发表于 2024-06-06 21:29:33">2024-06-06</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/">深度学习</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/%E8%AF%84%E4%BB%B7%E6%8C%87%E6%A0%87/">评价指标</a></span></div><div class="content">AP

APAPAP: 其实是mAP, IoU阈值从0.5开始, 每次间隔0.05, 直到0.95的10个mAP, 再取这10个mAP的平均值
APIoU=0.5AP^{IoU=0.5}APIoU=0.5: 是PASCAL VOC的评价指标, 表示当IoU=0.5时的mAP
APIoU=0.75AP^{IoU=0.75}APIoU=0.75: 表示当IoU=0.75时的mAP

AP Across Scales

APsmallAP^{small}APsmall: 只针对小物体, 也就是只保留GT框中的小物体, 然后IoU阈值从0.5开始, 每次间隔0.05, 直到0.95的10个mAP, 再取这10个mAP的平均值. 小物体的大小是面积小于32 * 32的物体
APmediumAP^{medium}APmedium: 只针对中等物体, 也就是只保留GT框中的中等物体, 然后IoU阈值从0.5开始, 每次间隔0.05, 直到0.95的10个mAP, 再取这10个mAP的平均值. 中等物体的大小是面积大于等于32 * 32且小于96 * 96的物体
APlargeAP^{large}AP ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2024/06/06/deep_learning/interview/evaluation_metrics/object_detection/" title="目标检测任务评价指标">目标检测任务评价指标</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2024-06-06T12:49:04.000Z" title="发表于 2024-06-06 20:49:04">2024-06-06</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/">深度学习</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/%E8%AF%84%E4%BB%B7%E6%8C%87%E6%A0%87/">评价指标</a></span></div><div class="content">TP, FP, TN, FN
TP(针对检测框): 置信度大于阈值, 且IoU &gt;= 阈值的检测框的数量
FP(针对检测框): 置信度大于阈值, 且IoU &lt; 阈值的检测框的数量. 如果有多个预测框匹配到GT框, 且IoU都大于等于阈值, 那么就选择IoU最高的检测框作为TP, 其他的检测框作为FP
TN(针对检测框): 置信度小于阈值的检测框的数量
FN(针对gt框): 漏检的gt框, 等于gt框的个数-TP
Precision, Recall
Precision=TPTP+FPPrecision=\frac{TP}{TP+FP}
Precision=TP+FPTP​
Recall=TPTP+FNRecall=\frac{TP}{TP+FN}
Recall=TP+FNTP​
PR曲线
PR曲线的横坐标表示召回率, 纵坐标表示精确度
曲线上的每一个点都对应模型在特定阈值下的精确率和召回率
P-R曲线越接近于右上角越好
流程示例
假设总共有10个样本, 其中正样本4个, 负样本6个
模型预测出这10个样本属于正样本的概率是[0.1, 0.2, 0.3, 0.4, 0.44,  ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2024/06/06/deep_learning/interview/evaluation_metrics/classification/" title="分类任务评价指标">分类任务评价指标</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2024-06-06T11:26:06.000Z" title="发表于 2024-06-06 19:26:06">2024-06-06</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/">深度学习</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/%E8%AF%84%E4%BB%B7%E6%8C%87%E6%A0%87/">评价指标</a></span></div><div class="content">混淆矩阵
对于一个二分类问题, 混淆矩阵通常是一个2×22\times 22×2的矩阵, 其中行表示实际类别, 列表示预测类别. 包含以下四个元素:

真正例(True Positive, TP): 模型正确地将正类别预测为正类别的样本数
真负例(True Negtive, TN): 模型正确地将负类别预测为负类别的样本数
假正例(False Positive, FP): 模型错误地将负类别预测为正类别的样本数
假负例(False Negative, FN): 模型错误地将正类别预测为负类别的样本数

准确率(Accuracy)
定义是在所有样本中, 被正确分类的比例
Accuracy=TP+TNTP+TN+FP+FNAccuracy=\frac{TP+TN}{TP+TN+FP+FN}
Accuracy=TP+TN+FP+FNTP+TN​
精确度/查准率(Precision)
定义是在预测为正类别样本中, 实际为正类别的比例
Accuracy=TPTP+FPAccuracy=\frac{TP}{TP+FP}
Accuracy=TP+FPTP​
召回率/查全率(Recall)
定义是在所 ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2024/06/06/deep_learning/interview/loss_function/alpha_iou_loss/" title="深度学习常用损失函数(Alpha IoU Loss)">深度学习常用损失函数(Alpha IoU Loss)</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2024-06-06T07:49:39.000Z" title="发表于 2024-06-06 15:49:39">2024-06-06</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/">深度学习</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/%E6%8D%9F%E5%A4%B1%E5%87%BD%E6%95%B0/">损失函数</a></span></div><div class="content">动机
给IoU以及所有的惩罚项都增加一个α\alphaα的指数, 在大多数情况下, α=3\alpha=3α=3效果最好
LIoU=1−IoU⟹Lα−IoU=1−IoUα\mathcal{L}_{\mathrm{IoU}}=1-IoU\Longrightarrow\mathcal{L}_{\alpha-\mathrm{IoU}}=1-IoU^{\alpha}
LIoU​=1−IoU⟹Lα−IoU​=1−IoUα
LGIoU=1−IoU+∣C∖(B∪Bgt)∣∣C∣⟹Lα−GIoU=1−IoUα+(∣C∖(B∪Bgt)∣∣C∣)α\mathcal{L}_{\mathrm{GIoU}}=1-IoU+\frac{|C\setminus(B\cup B^{gt})|}{|C|}\Longrightarrow\mathcal{L}_{\alpha-\mathrm{GIoU}}=1-IoU^\alpha+(\frac{|C\setminus(B\cup B^{gt})|}{|C|})^\alpha 
LGIoU​=1−IoU+∣C∣∣C∖(B∪Bgt)∣​⟹Lα−GIoU​=1−IoUα+(∣C∣ ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2024/06/06/deep_learning/interview/loss_function/eiou_loss/" title="深度学习常用损失函数(EIoU Loss和Focal-EIoU Loss)">深度学习常用损失函数(EIoU Loss和Focal-EIoU Loss)</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2024-06-06T07:49:13.000Z" title="发表于 2024-06-06 15:49:13">2024-06-06</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/">深度学习</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/%E6%8D%9F%E5%A4%B1%E5%87%BD%E6%95%B0/">损失函数</a></span></div><div class="content">动机
为了解决CIoU的三个问题

vvv仅仅反应了高宽比的相似性, 并没有给出wgtw^{gt}wgt和www的关系, 也没有给出hgth^{gt}hgt和hhh的关系, 也就是说只要高宽比一样, vvv就等于0
vvv对w的偏导数为∂v∂w=8π2(arctanwgthgt−arctanwh)∗hw2+h2\frac{\partial v}{\partial w}=\frac8{\pi^2}(arctan\frac{w^{gt}}{h^{gt}}-arctan\frac wh)*\frac h{w^2+h^2}∂w∂v​=π28​(arctanhgtwgt​−arctanhw​)∗w2+h2h​, vvv对hhh的偏导数为∂v∂h=−8π2(arctanwgthgt−arctanwh)∗ww2+h2\frac{\partial v}{\partial h}=-\frac{8}{\pi^2}(arctan\frac{w^{gt}}{h^{gt}}-arctan\frac{w}{h})*\frac{w}{w^2+h^2}∂h∂v​=−π28​(arctanhgtwgt​−arctanh ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2024/06/06/deep_learning/interview/loss_function/ciou_loss/" title="深度学习常用损失函数(CIoU Loss)">深度学习常用损失函数(CIoU Loss)</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2024-06-06T07:48:42.000Z" title="发表于 2024-06-06 15:48:42">2024-06-06</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/">深度学习</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/%E6%8D%9F%E5%A4%B1%E5%87%BD%E6%95%B0/">损失函数</a></span></div><div class="content">动机
DIoU虽然考虑了包围框的中心点的距离, 但是没有考虑包围框的高宽比, 即使中心点距离一样, 也应该是高宽比更贴合GT框的Loss更小
CIoU Loss
在DIoU Loss的基础上考虑了高宽比的相似程度
RCIoU=ρ2(b,bgt)c2+αvR_{CIoU}=\frac{\rho^2(b,b^{gt})}{c^2}+\alpha v
RCIoU​=c2ρ2(b,bgt)​+αv
其中v=4π2(arctanwgthgt−arctanwh)2v=\frac4{\pi^2}(arctan\frac{w^{gt}}{h^{gt}}-arctan\frac wh)^2v=π24​(arctanhgtwgt​−arctanhw​)2, α=v(1−IoU)+v\alpha=\frac v{(1-IoU)+v}α=(1−IoU)+vv​
代码示例
123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051import torchimport torch.nn  ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2024/06/06/deep_learning/interview/loss_function/diou_loss/" title="深度学习常用损失函数(DIoU Loss)">深度学习常用损失函数(DIoU Loss)</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2024-06-06T07:48:09.000Z" title="发表于 2024-06-06 15:48:09">2024-06-06</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/">深度学习</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/%E6%8D%9F%E5%A4%B1%E5%87%BD%E6%95%B0/">损失函数</a></span></div><div class="content">动机
主要是为了解决GIoU loss的问题

当目标框完全包裹预测框的时候, GIoU退化成IoU, 无法区分相对位置关系

为了解决这个问题, DIoU将GIoU中的最小外接框的惩罚项修改成最小化两个包围框中心点的归一化距离
DIoU Loss
定义如下
L=1−IoU+R(B,Bgt)L=1-IoU+R(B,B^{gt})
L=1−IoU+R(B,Bgt)
其中,RDIoU=ρ2(b,bgt)c2R_{DIoU}=\frac{\rho^2(b,b^{gt})}{c^2}RDIoU​=c2ρ2(b,bgt)​, ρ\rhoρ表示中心点的欧式距离, ccc表示最小外接框的对角线长度
性质

惩罚项是一个相对度量, 和包围框的尺寸关系不大
如果两个包围框不相交, 那么DIoU直接优化中心点的距离, 收敛更快
当两个框包含的情况下, DIoU也可以收敛的很快, GIoU Loss会退化成IoU loss

代码示例
1234567891011121314151617181920212223242526272829303132333435363738394041424344import t ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2024/06/06/deep_learning/interview/loss_function/giou_loss/" title="深度学习常用损失函数(GIoU Loss)">深度学习常用损失函数(GIoU Loss)</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2024-06-06T07:41:19.000Z" title="发表于 2024-06-06 15:41:19">2024-06-06</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/">深度学习</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/%E6%8D%9F%E5%A4%B1%E5%87%BD%E6%95%B0/">损失函数</a></span></div><div class="content">动机
当两个包围框不相交的时候, IoU Loss不能反应两个框距离的远近, 且损失函数不可导
即使两个包围框IoU相同, 他们的相交方式也可能不同
GIoU loss
在此基础上提出了GIoU loss
LGIoU=1−IoU+C−(A∪B)∣C∣L_{GIoU}=1-IoU+\frac{C-(A\cup B)}{|C|}
LGIoU​=1−IoU+∣C∣C−(A∪B)​
代码实现
1234567891011121314151617181920212223242526272829303132333435363738394041424344import torchimport torch.nn as nnclass GIouLoss(nn.Module):    def __init__(self):        super().__init__()        def forward(self, bbox1, bbox2):        bbox2 = bbox2.t()        x11, y11, x12, y12 = bbox1        x21, y21, x2 ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2024/06/06/deep_learning/interview/loss_function/iou_loss/" title="深度学习常用损失函数(IoU Loss)">深度学习常用损失函数(IoU Loss)</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2024-06-06T07:40:48.000Z" title="发表于 2024-06-06 15:40:48">2024-06-06</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/">深度学习</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/%E6%8D%9F%E5%A4%B1%E5%87%BD%E6%95%B0/">损失函数</a></span></div><div class="content">动机
如果使用L1 Loss, L2 Loss, Smooth L1 Loss来计算4个坐标点的loss之和, 来作为定位的损失. 会存在不同的包围框, loss是一样的, 但是他们和GT框的IoU不一样
上面的三个Loss是相互独立的, 但是四个坐标其实是存在关联的
另外大的包围框这些loss就会比较大, 小的包围框这些loss会比较小, 因此模型会优先优化大的包围框
IoU loss
在此基础上提出了IoU loss
LIoU=−ln(IoU)L_{IoU}=-ln(IoU)
LIoU​=−ln(IoU)
为了方便梯度计算, 在IoU的基础上, 求了log, 为了使IoU越大损失越小, 在前面加了负号
也有地方将IoU loss直接定义成
LIoU=1−IoUL_{IoU}=1-IoU
LIoU​=1−IoU
代码实现
12345678910111213141516171819202122232425262728293031import torchimport torch.nn as nnclass IouLoss(nn.Module):    def __init__(self) ...</div></div></div><nav id="pagination"><div class="pagination"><a class="extend prev" rel="prev" href="/"><i class="fas fa-chevron-left fa-fw"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/#content-inner">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/12/#content-inner">12</a><a class="extend next" rel="next" href="/page/3/#content-inner"><i class="fas fa-chevron-right fa-fw"></i></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/avatar.jpeg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Grapymage</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">119</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">66</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">56</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/zhangtingyu11"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">无</div></div><div class="sticky_layout"><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/06/26/deep_learning/stanford_ml/chapter11/" title="斯坦福2021秋季·实用机器学习(第十一章)">斯坦福2021秋季·实用机器学习(第十一章)</a><time datetime="2024-06-26T07:04:34.000Z" title="发表于 2024-06-26 15:04:34">2024-06-26</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/06/26/deep_learning/stanford_ml/chapter10/" title="斯坦福2021秋季·实用机器学习(第十章)">斯坦福2021秋季·实用机器学习(第十章)</a><time datetime="2024-06-26T07:04:11.000Z" title="发表于 2024-06-26 15:04:11">2024-06-26</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/06/26/deep_learning/stanford_ml/chapter9/" title="斯坦福2021秋季·实用机器学习(第九章)">斯坦福2021秋季·实用机器学习(第九章)</a><time datetime="2024-06-26T07:03:24.000Z" title="发表于 2024-06-26 15:03:24">2024-06-26</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/06/26/deep_learning/stanford_ml/chapter5/" title="斯坦福2021秋季·实用机器学习(第五章)">斯坦福2021秋季·实用机器学习(第五章)</a><time datetime="2024-06-26T07:02:34.000Z" title="发表于 2024-06-26 15:02:34">2024-06-26</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/06/26/deep_learning/stanford_ml/chapter4/" title="斯坦福2021秋季·实用机器学习(第四章)">斯坦福2021秋季·实用机器学习(第四章)</a><time datetime="2024-06-26T06:56:43.000Z" title="发表于 2024-06-26 14:56:43">2024-06-26</time></div></div></div></div><div class="card-widget card-categories"><div class="item-headline">
            <i class="fas fa-folder-open"></i>
            <span>分类</span>
            <a class="card-more-btn" href="/categories/" title="查看更多">
    <i class="fas fa-angle-right"></i></a>
            </div>
            <ul class="card-category-list" id="aside-cat-list">
            <li class="card-category-list-item "><a class="card-category-list-link" href="/categories/CUDA%E7%BC%96%E7%A8%8B/"><span class="card-category-list-name">CUDA编程</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/TensorRT/"><span class="card-category-list-name">TensorRT</span><span class="card-category-list-count">1</span></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/TensorRT/CenterPoint/"><span class="card-category-list-name">CenterPoint</span><span class="card-category-list-count">1</span></a></li></ul></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/cmake/"><span class="card-category-list-name">cmake</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/cpp/"><span class="card-category-list-name">cpp</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/python3/"><span class="card-category-list-name">python3</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E6%9D%82%E7%B1%BB/"><span class="card-category-list-name">杂类</span><span class="card-category-list-count">3</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/"><span class="card-category-list-name">深度学习</span><span class="card-category-list-count">51</span></a></li>
            </ul></div><div class="card-widget card-tags"><div class="item-headline"><i class="fas fa-tags"></i><span>标签</span></div><div class="card-tag-cloud"><a href="/tags/%E6%9E%9A%E4%B8%BE/" style="font-size: 1.23em; color: #999ea6">枚举</a> <a href="/tags/python3/" style="font-size: 1.5em; color: #99a9bf">python3</a> <a href="/tags/%E5%9B%9E%E6%BA%AF/" style="font-size: 1.14em; color: #999b9d">回溯</a> <a href="/tags/MMEngine/" style="font-size: 1.14em; color: #999b9d">MMEngine</a> <a href="/tags/%E6%A8%A1%E5%9E%8B%E6%9E%B6%E6%9E%84/" style="font-size: 1.14em; color: #999b9d">模型架构</a> <a href="/tags/pytorch/" style="font-size: 1.28em; color: #99a0aa">pytorch</a> <a href="/tags/%E8%BD%AF%E4%BB%B6%E5%AE%89%E8%A3%85/" style="font-size: 1.14em; color: #999b9d">软件安装</a> <a href="/tags/%E7%BA%AF%E7%9B%B8%E6%9C%BA3D%E7%9B%AE%E6%A0%87%E6%A3%80%E6%B5%8B/" style="font-size: 1.41em; color: #99a5b7">纯相机3D目标检测</a> <a href="/tags/%E6%95%B0%E5%AD%A6/" style="font-size: 1.19em; color: #999da1">数学</a> <a href="/tags/%E9%80%92%E5%BD%92/" style="font-size: 1.19em; color: #999da1">递归</a> <a href="/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/" style="font-size: 1.41em; color: #99a5b7">机器学习</a> <a href="/tags/KITTI/" style="font-size: 1.14em; color: #999b9d">KITTI</a> <a href="/tags/%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/" style="font-size: 1.14em; color: #999b9d">博客搭建</a> <a href="/tags/%E5%A4%9A%E6%A8%A1%E6%80%81/" style="font-size: 1.14em; color: #999b9d">多模态</a> <a href="/tags/%E5%B7%AE%E5%88%86%E6%95%B0%E7%BB%84/" style="font-size: 1.19em; color: #999da1">差分数组</a> <a href="/tags/CUDA%E7%BC%96%E7%A8%8B/" style="font-size: 1.14em; color: #999b9d">CUDA编程</a> <a href="/tags/3D%E7%9B%AE%E6%A0%87%E6%A3%80%E6%B5%8B/" style="font-size: 1.14em; color: #999b9d">3D目标检测</a> <a href="/tags/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/" style="font-size: 1.46em; color: #99a7bb">深度学习</a> <a href="/tags/%E5%AD%A6%E4%B9%A0%E7%8E%87%E7%AD%96%E7%95%A5/" style="font-size: 1.14em; color: #999b9d">学习率策略</a> <a href="/tags/%E7%AE%97%E6%B3%95%E5%B8%B8%E7%94%A8%E6%8A%80%E5%B7%A7/" style="font-size: 1.19em; color: #999da1">算法常用技巧</a> <a href="/tags/%E5%AD%A6%E4%B9%A0%E7%8E%87%E8%B0%83%E5%BA%A6%E5%99%A8/" style="font-size: 1.14em; color: #999b9d">学习率调度器</a> <a href="/tags/%E4%BB%A3%E7%A0%81%E8%A7%A3%E6%9E%90/" style="font-size: 1.32em; color: #99a2ae">代码解析</a> <a href="/tags/%E6%95%B0%E7%BB%84/" style="font-size: 1.14em; color: #999b9d">数组</a> <a href="/tags/%E6%BB%91%E5%8A%A8%E7%AA%97%E5%8F%A3/" style="font-size: 1.28em; color: #99a0aa">滑动窗口</a> <a href="/tags/%E6%95%B0%E6%8D%AE%E5%A2%9E%E5%BC%BA/" style="font-size: 1.23em; color: #999ea6">数据增强</a> <a href="/tags/%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A6/" style="font-size: 1.14em; color: #999b9d">组合数学</a> <a href="/tags/yolo/" style="font-size: 1.14em; color: #999b9d">yolo</a> <a href="/tags/%E5%AE%9E%E9%AA%8C%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/" style="font-size: 1.28em; color: #99a0aa">实验环境搭建</a> <a href="/tags/%E6%B7%B1%E5%BA%A6%E4%BC%98%E5%85%88%E6%90%9C%E7%B4%A2/" style="font-size: 1.28em; color: #99a0aa">深度优先搜索</a> <a href="/tags/%E6%9C%80%E7%9F%AD%E8%B7%AF/" style="font-size: 1.14em; color: #999b9d">最短路</a> <a href="/tags/Leetcode-python3/" style="font-size: 1.1em; color: #999">Leetcode. python3</a> <a href="/tags/Leetcode/" style="font-size: 1.5em; color: #99a9bf">Leetcode</a> <a href="/tags/TensorRT/" style="font-size: 1.14em; color: #999b9d">TensorRT</a> <a href="/tags/vscode/" style="font-size: 1.14em; color: #999b9d">vscode</a> <a href="/tags/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E9%87%8C%E7%9A%84%E6%95%B0%E5%AD%A6/" style="font-size: 1.14em; color: #999b9d">深度学习里的数学</a> <a href="/tags/%E6%A8%A1%E6%8B%9F/" style="font-size: 1.37em; color: #99a4b2">模拟</a> <a href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%A7%86%E8%A7%89/" style="font-size: 1.14em; color: #999b9d">计算机视觉</a> <a href="/tags/%E5%B9%BF%E5%BA%A6%E4%BC%98%E5%85%88%E6%90%9C%E7%B4%A2/" style="font-size: 1.14em; color: #999b9d">广度优先搜索</a> <a href="/tags/%E8%AF%84%E4%BB%B7%E6%8C%87%E6%A0%87/" style="font-size: 1.37em; color: #99a4b2">评价指标</a> <a href="/tags/%E4%BA%8C%E5%8F%89%E6%90%9C%E7%B4%A2%E6%A0%91/" style="font-size: 1.14em; color: #999b9d">二叉搜索树</a></div></div><div class="card-widget card-archives"><div class="item-headline"><i class="fas fa-archive"></i><span>归档</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/06/"><span class="card-archive-list-date">六月 2024</span><span class="card-archive-list-count">30</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/05/"><span class="card-archive-list-date">五月 2024</span><span class="card-archive-list-count">10</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/01/"><span class="card-archive-list-date">一月 2024</span><span class="card-archive-list-count">17</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/12/"><span class="card-archive-list-date">十二月 2023</span><span class="card-archive-list-count">55</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/11/"><span class="card-archive-list-date">十一月 2023</span><span class="card-archive-list-count">7</span></a></li></ul></div><div class="card-widget card-webinfo"><div class="item-headline"><i class="fas fa-chart-line"></i><span>网站资讯</span></div><div class="webinfo"><div class="webinfo-item"><div class="item-name">文章数目 :</div><div class="item-count">119</div></div><div class="webinfo-item"><div class="item-name">本站总字数 :</div><div class="item-count">124.1k</div></div><div class="webinfo-item"><div class="item-name">本站访客数 :</div><div class="item-count" id="busuanzi_value_site_uv"><i class="fa-solid fa-spinner fa-spin"></i></div></div><div class="webinfo-item"><div class="item-name">本站总访问量 :</div><div class="item-count" id="busuanzi_value_site_pv"><i class="fa-solid fa-spinner fa-spin"></i></div></div><div class="webinfo-item"><div class="item-name">最后更新时间 :</div><div class="item-count" id="last-push-date" data-lastPushDate="2024-06-26T07:06:08.498Z"><i class="fa-solid fa-spinner fa-spin"></i></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('/img/index.jpg')"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2024 By Grapymage</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"><script>window.typedJSFn = {
  init: (str) => {
    window.typed = new Typed('#subtitle', Object.assign({
      strings: str,
      startDelay: 300,
      typeSpeed: 150,
      loop: true,
      backSpeed: 50,
    }, null))
  },
  run: (subtitleType) => {
    if (true) {
      if (typeof Typed === 'function') {
        subtitleType()
      } else {
        getScript('https://cdn.jsdelivr.net/npm/typed.js/dist/typed.umd.min.js').then(subtitleType)
      }
    } else {
      subtitleType()
    }
  }
}
</script><script>function subtitleType () {
  if (true) {
    typedJSFn.init(["纸上得来终觉浅，绝知此事要躬行"])
  } else {
    document.getElementById("subtitle").textContent = "纸上得来终觉浅，绝知此事要躬行"
  }
}
typedJSFn.run(subtitleType)</script></div><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-heart.min.js" async="async" mobile="true"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>